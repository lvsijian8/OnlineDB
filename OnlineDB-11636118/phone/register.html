<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">
    <head>
        <title></title>
        <meta charset="utf-8">
        <meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <link rel="stylesheet" href="css/fonts/font-awesome.min.css">
        <link rel="stylesheet" href="css/ui-box.css">
        <link rel="stylesheet" href="css/ui-base.css">
        <link rel="stylesheet" href="css/ui-color.css">
        <link rel="stylesheet" href="css/appcan.icon.css">
        <link rel="stylesheet" href="css/appcan.control.css">
    </head>
    <body class="um-vp bc-bg" ontouchstart>
        <div id="page_0" class="up ub ub-ver bc-bg" tabindex="0">
            <!--header开始-->
            <div id="header" class="uh bc-text-head ub bc-head">
                <div class="nav-btn" id="">
                </div>
                <h1 class="ut ub-f1 ulev-3 ut-s tx-c" tabindex="0">注册</h1>
                <div class="nav-btn" id="nav-right">
                    <!--按钮开始-->
                    
                    <!--按钮结束-->
                </div>
            </div>
            <!--header结束--><!--content开始-->
        <div class="c-wh uinnh5 umar-a ub-ac ub-pc">
        <div class="umar-t">
                <div class="ub ub-ac ub-pc umar-t">
                    <img src="css/icons/logo.png" style="width: 10.625em;height: auto" />
                </div>
            </div>
            <form method="get" action="">
            <div class="uba uc-a1 bc-border umar-t umar-b">
                <div class="ub uinn5 bc-border ubb">
                    <div class="ub ub-ac uw-reg ulev-app1">用户名</div>
                    <div class="ub ub-ac ub-f1">
                        <div class="uinput ub ub-f1">
                            <input placeholder="请输入您的昵称" type="text" id="username" name="username" class="ub-f1" onkeyup="this.value=this.value.replace(' ','')">
                        </div>
                    </div>
                </div>
                <div class="ub uinn5 bc-border ubb">
                    <div class="ub ub-ac uw-reg ulev-app1">手机号码</div>
                    <div class="ub ub-ac ub-f1">
                        <div class="uinput ub ub-f1">
                            <input placeholder="请输入您常用的手机号码" type="tel" id="mobile" name="mobile" class="ub-f1" pattern="[0-9]{11}" onkeyup="this.value=this.value.replace(' ','')">
                        </div>
                    </div>
                </div>
                <div class="ub uinn5 bc-border ubb">
                    <div class="ub ub-ac uw-reg ulev-app1">邮箱地址</div>
                    <div class="ub ub-ac ub-f1">
                        <div class="uinput ub ub-f1">
                            <input placeholder="请输入您常用的邮箱地址" type="email" id="email" name="email" class="ub-f1" onkeyup="this.value=this.value.replace(' ','')">
                        </div>
                    </div>
                </div>
                <div class="ub uinn5 bc-border ubb">
                    <div class="ub ub-ac uw-reg ulev-app1">设置密码</div>
                    <div class="ub ub-ac ub-f1">
                        <div class="uinput ub ub-f1">
                            <input placeholder="输入6~20位字符" type="password" id="password" name="password" class="ub-f1" pattern="^[a-zA-Z]\w{5,17}$" onkeyup="this.value=this.value.replace(' ','')">
                        </div>
                    </div>
                </div>
                <div class="ub uinn5">
                    <div class="ub ub-ac uw-reg ulev-app1">确认密码</div>
                    <div class="ub ub-ac  ub-f1">
                        <div class="uinput ub ub-f1">
                            <input placeholder="再次输入设置的密码" type="password" id="check_password" name="check_password" class="ub-f1" onkeyup="this.value=this.value.replace(' ','')">
                        </div>
                    </div>
                </div>
            </div>
            <div class="uinn-at1 umar-t">
                <div class="btn ub ub-ac bc-text-head ub-pc bc-btn umar-t uc-a1"  id="register" >注册
                </div>
            </div>
            <br>
            <div class="uinn-at2 ub sc-text-active ulev-4" onclick="openLogin()">
                <div class="ub-f1" style="cursor: pointer">返回登录页面</div>
            </div>
            </form>
        </div>
    </div>    
    </body>
    <script src="js/appcan.js"></script>
    <script src="js/appcan.control.js"></script>
    <script src="js/appcan.listview.js"></script>
    <script src="js/util_url.js"></script>
    </body>
    <script>
        appcan.ready(function() {
            appcan.initBounce();
        })
 
        appcan.button("#register", "ani-act", function() {
            var username = document.getElementById("username").value;
            var mobile = document.getElementById("mobile").value;
            var email = document.getElementById("email").value;
            var password = document.getElementById("password").value;
            var check_password = document.getElementById("check_password").value;
            if(username == ""||(!/[^\d]{3,}/.test(username))){
                //appcan.window.openToast("请输入用户名！", 3000, '5', '0');
                uexWindow.alert("提示","请输入至少3个字符的用户名！","确定");
                return;
            }
            if(mobile == ""||(!/^[1]+[3,5,8]+\d{9}/.test(mobile))){
                //appcan.window.openToast("请输入手机号码！", 3000, '5', '0');
                uexWindow.alert("提示","请输入有效的手机号码！","确定");
                return;
            }
            if(email == ""||(!/^(\w-*\.*)+@(\w-?)+(\.\w{2,})+$/.test(email))){
                //appcan.window.openToast("请输入邮箱地址！", 3000, '5', '0');
                uexWindow.alert("提示","请输入有效的邮箱地址！","确定");
                return;
            }
            if(password == ""||(!/^[0-9A-Za-z]{2,21}$/.test(password))){
                //appcan.window.openToast("请输入密码！", 3000, '5', '0');
                uexWindow.alert("提示","请输入至少2个字符或数字的密码！","确定");
                return;
            }
            if(check_password == ""||(!/^[0-9A-Za-z]{2,21}$/.test(check_password))){
                //appcan.window.openToast("请输入确认密码！", 3000, '5', '0');
                uexWindow.alert("提示","请输入至少2个字符或数字的确认密码！","确定");
                return;
            }
            if(check_password != password){
                //appcan.window.openToast("密码不一致，请重新输入！", 3000, '5', '0');
                uexWindow.alert("提示","密码不一致，请重新输入！","确定");
                return;
            }
            appcan.ajax({
                url : server_url+'/register.action',
                type : 'GET',
                dataType:"json",
                data : {
                    "user.userName" : username,
                    "user.userPassword" : password,
                    "user.phone" : mobile,
                    "user.email" : email,
                },
                success : function(data) {
                    if (data.user.userId > 0) {//登陆成功
                        appcan.locStorage.setVal("user_id",data.user.userId);
                        appcan.locStorage.setVal("user_name",data.user.userName);
                        appcan.locStorage.setVal("user_email",data.user.email);
                        appcan.window.openToast('注册成功', '2000');
                        var timer = setTimeout(function() {
                            appcan.openWinWithUrl('index', 'index.html');
                            //页面跳转
                        }, 2000);
                    }else {
                        appcan.window.openToast('注册失败,用户名已存在', '2000');
                    }
                }
            });
        })
 
        //返回登录页面
        function openLogin(){
            appcan.window.open({
                name : 'login',
                data : 'login.html',
            });
        }
    </script>
</html>